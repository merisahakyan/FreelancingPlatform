
@using Microsoft.AspNetCore.Identity
@using MVC.Data
@using System.Security.Claims;

@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager

@model Core.Models.BusinessModels.WorkModel

@{
    ViewData["Title"] = "JobDetails";
}

<h2>Details</h2>
@{
    Roles? userRole = null;
    if (User != null && User.Identity != null)
    {
        var claim = User.Claims.FirstOrDefault(c => c.Type == ClaimTypes.NameIdentifier);
        User user;
        if (claim != null)
        {
            user = UserManager.FindByIdAsync(claim.Value).Result;
            userRole = user.Role;
        }
    }
}
<div>

    <dl class="dl-horizontal">
        <dt>
            @Html.DisplayNameFor(model => model.Id)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Id)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Header)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Header)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Description)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Description)
        </dd>
        @if (userRole == Roles.Freelancer)
        {
            <dt></dt>
            <dd>@Html.ActionLink("Apply", "ApplyHire", new { id = Model.Id })</dd>
        }
    </dl>
</div>
<div>
    @Html.ActionLink("Back to list", "Jobs", new { })
</div>
